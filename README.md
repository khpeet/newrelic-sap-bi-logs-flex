# SAP PI Channel Logs to New Relic

Bash script / flex integration that reads a SAP communication channel log file generated by [this separate New Relic extension](https://github.com/newrelic-experimental/newrelic-java-sap-bi/blob/main/Logs/Logging.md), and forwards those logs as events to New Relic.

## Requirements
* Infrastructure agent installed (Linux)

## Configuration

### channels.sh
At the top of this script, configure `LOGS_PATH` with the full direct path to where communication channel logs are written to. Configure `CHANNEL_SUMMARY_FILE` to the name of `channels.log` - typically the default filename can be used.

### channels.yml
Nothing should be modified in this file, unless the placement of `channels.sh` is outside of the normal directory: `/var/db/newrelic-infra/integrations.d`. The polling interval is currently 2 minutes to read the log file and send the latest logs to New Relic - This can be modified as needed.

## Setup
1. Configure shell script per [Configuration](#configuration) section above
2. Place `channels.sh` and `channels.yml` within `/var/db/newrelic-infra/integrations.d`
3. Restart Infrastructure agent

## Troubleshooting
Enable debug logging within the Infrastructure agent config file: https://docs.newrelic.com/docs/infrastructure/infrastructure-troubleshooting/troubleshoot-logs/generate-logs-troubleshooting-infrastructure/

Look for error logs related to "flex", alternatively flex can be ran locally via command line to validate the config output:

```
./nri-flex --verbose --config_file /var/db/newrelic-infra/integrations.d/channels.yml
```
